<div *ngIf="loading"><h2>{{ 'loading' | translate }}...</h2></div>
<div *ngIf="!loading" class="TasksManagementList">
    <h1>{{ sprintTasksManagementService.sprint.name }}</h1>

    <div class="row margin-bottom-20px">
        <div class="col-xs-12">
            <button md-raised-button type="button"
                    routerLink="/sprints">
                <md-icon>keyboard_arrow_left</md-icon>
                <span class="hidden-xs">{{ 'sprints.list' | translate }}</span>
            </button>
            &nbsp;&nbsp;
            <button md-raised-button color="primary" type="button"
                    (click)="editDay()">
                <md-icon>add</md-icon>
                <span class="hidden-xs">{{ 'add.day' | translate }}</span>
            </button>
        </div>
    </div>

    <md-card class="margin-bottom-20px">
        <md-card-content class="overflow-auto">
            <table class="table table-striped table-bordered table-hover table-condensed table-responsive">
                <thead>
                    <tr>
                        <th width="100px">{{ 'date' | translate }}</th>
                        <th *ngFor="let user of usersHeader">{{ user.name }}</th>
                        <th width="100px">{{ 'total' | translate }}</th>
                        <th width="80px">{{ 'action' | translate }}</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let line of data">
                        <td align="center" valign="middle">{{ line.date | moment:'DD/MM/YYYY' }}</td>
                        <td *ngFor="let user of usersHeader">
                            <div *ngIf="line.users[user.id] !== undefined"
                                 style="display: flex; justify-content: space-around">
                                {{ line.users[user.id].duration | duration:'hour' }} / {{ line.users[user.id].workedDuration | duration:'hour' }}
                            </div>
                        </td>
                        <td align="center" valign="middle">
                            {{ line.duration | duration:'hour' }} / {{ line.workedDuration | duration:'hour' }} / {{ line.performance | percentFr:0 }}
                        </td>
                        <td align="center" valign="middle">
                            <button md-button type="button"
                                    color="accent" class="md-button-small-width"
                                    (click)="editDay(line.date)">
                                <span class="fa fa-pencil"></span>
                            </button>
                        </td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <th>{{ 'duration.total' | translate }}</th>
                        <th class="text-center" *ngFor="let user of usersHeader">
                            {{ usersTotal[user.id].duration | duration:'hour' }} / {{ usersTotal[user.id].workedDuration | duration:'hour' }}
                        </th>
                        <th class="text-center">
                            {{ totalDuration | duration:'hour' }} / {{ totalWorkedDuration | duration:'hour' }}
                        </th>
                        <th></th>
                    </tr>
                    <tr>
                        <th>{{ 'performance' | translate }}</th>
                        <th class="text-center" *ngFor="let user of usersHeader">
                            {{ usersTotal[user.id].performance | percentFr:0 }}
                        </th>
                        <th class="text-center">{{ totalPerformance | percentFr:0 }}</th>
                        <th></th>
                    </tr>
                </tfoot>
            </table>
        </md-card-content>
    </md-card>

    <div class="row margin-bottom-20px">
        <div class="col-xs-12">
            <button md-raised-button type="button"
                    routerLink="/sprints">
                <md-icon>keyboard_arrow_left</md-icon>
                <span class="hidden-xs">{{ 'sprints.list' | translate }}</span>
            </button>
            &nbsp;&nbsp;
            <button md-raised-button color="primary" type="button"
                    (click)="editDay()">
                <md-icon>add</md-icon>
                <span class="hidden-xs">{{ 'add.day' | translate }}</span>
            </button>
        </div>
    </div>
</div>